"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1314],{51314:function(e,t,n){n.d(t,{Z:function(){return v}});var i=n(58936),r=n(27573),a=n(16096),s=n(91600),o=n(89937),l=n(96111),c=n(92472),u=n(56109),d=n(43316),h=n(41911),p=n(71875),m=n(54603),f=n(7653),g=n(70913);function y(){let e=(0,i._)(["text-lg mb-6"]);return y=function(){return e},e}let x={poll_for_invoice:1e4,poll_for_payment:8e3,poll_for_capability:5e3};function _(e,t){let n=window.setTimeout(e,t);return()=>{window.clearTimeout(n)}}function v(e){let t,{onComplete:n,productCapability:i,refetchOrganization:c,isLoadingOrganization:u,organization:h}=e,{account:y,refetch:v,isLoading:N,activeOrganization:E}=(0,a.useCurrentAccount)(),{state:F,stateTakingTooLong:P}=function(e){var t;let{productCapability:n,refetch:i,isLoading:r,organization:a}=e,[o,l]=(0,f.useState)("poll_for_invoice"),[c,u]=(0,f.useState)(!1);(0,f.useEffect)(()=>_(()=>{l(e=>"success"===e||"payment_failed"===e?e:"timed_out")},6e4),[]),(0,f.useEffect)(()=>{u(!1);let e=x[o];if(e)return _(()=>{u(!0)},e)},[o]);let h=null==a?void 0:a.capabilities.includes(n),[m]=(0,f.useState)(()=>p.ou.now()),{data:y,refetch:v,isFetching:C,isError:b}=(0,g.MH)({limit:1,createdSince:m.minus({minute:30}),organizationUUID:null==a?void 0:a.uuid});(0,f.useEffect)(()=>{if(("poll_for_invoice"===o||"poll_for_payment"===o||"payment_requires_confirmation"===o)&&!C&&!b)return _(()=>{v()},2e3)},[o,v,C,b]),(0,f.useEffect)(()=>{if("poll_for_capability"===o&&!r)return _(()=>{i().catch(e=>{(0,d.Tb)(e)})},2e3)},[o,i,r]);let j=null==y?void 0:y[0],w=null==j?void 0:j.status,k=null==j?void 0:null===(t=j.payment_intent)||void 0===t?void 0:t.status;return(0,f.useEffect)(()=>{switch(o){case"poll_for_invoice":if("void"===w)return _(()=>{l("payment_failed")},Math.max(m.plus(6e3).diffNow().milliseconds,0));w&&l("poll_for_payment");return;case"poll_for_payment":if("paid"===w)l("poll_for_capability");else{if("requires_confirmation"===k)return _(()=>{l("payment_requires_confirmation")},6e3);("void"===w||"requires_payment_method"===k)&&l("payment_failed")}return;case"payment_requires_confirmation":"paid"===w?l("poll_for_capability"):("void"===w||"requires_payment_method"===k)&&l("payment_failed");return;case"poll_for_capability":h&&("claude_pro"===n?(0,s.bq)("event","pro_subscription_purchase"):"raven"===n&&(0,s.bq)("event","team_subscription_started"),l("success"));return}},[o,w,k,h,n,m]),{state:o,stateTakingTooLong:c}}({productCapability:i,refetch:null!=c?c:v,isLoading:null!=u?u:N,organization:null!=h?h:E}),L=(0,m.usePathname)(),T=(0,m.useRouter)(),q=(0,o.K)();if((0,f.useEffect)(()=>{q.track("payment_state_".concat(F))},[q,F]),(0,f.useEffect)(()=>{"payment_failed"===F&&T.replace(L)},[F,T,L]),"timed_out"===F)return(0,r.jsxs)(C,{title:"Unable to confirm payment",children:[(0,r.jsx)(j,{children:"This may be because of network issues. You can try reloading the page."}),(0,r.jsx)(j,{children:"We’re still trying to confirm your payment: you’ll get an email if it is successfully processed."}),(0,r.jsxs)(j,{children:["If the problem persists please"," ",(0,r.jsx)("a",{href:"https://support.anthropic.com/",className:"underline",target:"_blank",children:"contact support"}),"."]})]});if("payment_failed"===F)return(0,r.jsxs)(C,{title:"Payment failed",children:[(0,r.jsx)(j,{children:"Looks like that payment didn’t go through."}),(0,r.jsx)(l.Z,{size:"lg",onClick:()=>n({retry:!0,success:!1}),children:"Try another payment method"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("button",{className:"text-lg font-semibold hover:underline",onClick:()=>n({retry:!1,success:!1}),children:"Try again later"})})]});if("success"===F)return(0,r.jsxs)(b,{children:[(0,r.jsx)(w,{}),(0,r.jsx)(k,{product:i,name:null==y?void 0:y.display_name,orgName:null==h?void 0:h.name,onComplete:()=>n({retry:!1,success:!0})})]});let W="Processing payment...";return P?t=(0,r.jsxs)(r.Fragment,{children:["Taking a bit longer than usual. If the problem persists please"," ",(0,r.jsx)("a",{href:"https://support.anthropic.com/",className:"underline",target:"_blank",children:"contact support"}),"."]}):"poll_for_invoice"===F?t=(0,r.jsx)(r.Fragment,{children:"Don’t navigate away from this page yet"}):"poll_for_payment"===F?t=(0,r.jsx)(r.Fragment,{children:"Nearly done, just confirming the payment on our end."}):"poll_for_capability"===F?t=(0,r.jsx)(r.Fragment,{children:"Payment confirmed, activating your subscription."}):"payment_requires_confirmation"===F&&(W="Seems to be taking a while...",t=(0,r.jsxs)(r.Fragment,{children:["You might have received an email that requires you to approve the payment. If that isn’t the case, please"," ",(0,r.jsx)("a",{href:"https://support.anthropic.com/",className:"underline",target:"_blank",children:"contact support"}),"."]})),(0,r.jsxs)(b,{children:[(0,r.jsx)(w,{}),(0,r.jsx)("h2",{className:"font-styrene-display mb-1 mt-4 text-2xl font-medium",children:W}),(0,r.jsx)(j,{children:t})]})}let C=e=>{let{title:t,children:n}=e;return(0,r.jsxs)(b,{children:[(0,r.jsx)("div",{className:"bg-oncolor-100/10 inline-block rounded-full p-5",children:(0,r.jsx)(u.v,{size:40,className:"-translate-y-px"})}),(0,r.jsx)("h2",{className:"font-styrene-display mb-1 mt-3 text-2xl font-medium",children:t}),n]})},b=e=>{let{children:t}=e;return(0,r.jsxs)("div",{className:"absolute inset-0 z-30 flex h-full w-full items-center justify-center text-center text-white",children:[(0,r.jsx)(h.E.div,{className:"bg-accent-pro-100/90 absolute inset-0",exit:{opacity:0},transition:{duration:.35}}),(0,r.jsx)(h.E.div,{className:"relative z-10 mb-4 min-h-[250px] max-w-3xl pl-4 pr-4",exit:{opacity:0,scale:.9},transition:{duration:.25},children:t})]})},j=c.Z.p(y()),w=()=>(0,r.jsx)("svg",{className:"inline-block",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{className:"origin-center animate-spin",d:"M77 40C77 60.4345 60.4345 77 40 77C19.5655 77 3 60.4345 3 40C3 19.5655 19.5655 3 40 3",stroke:"currentColor",strokeWidth:"4"})}),k=e=>{let{name:t,orgName:n,onComplete:i,product:a}=e;(0,f.useEffect)(()=>_(i,3500),[i]);let s="claude_pro"===a?(0,r.jsx)(r.Fragment,{children:"Welcome to Pro"}):t&&n?(0,r.jsxs)(r.Fragment,{children:["Welcome to ",n,", ",t]}):n?(0,r.jsxs)(r.Fragment,{children:["Welcome to ",n]}):t?(0,r.jsxs)(r.Fragment,{children:["Welcome to the Team Plan, ",t]}):(0,r.jsx)(r.Fragment,{children:"Welcome to the Team"});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute left-0 top-0 w-full",children:(0,r.jsxs)("svg",{className:"inline-block",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)(h.E.circle,{cx:"40",cy:"40",r:"37",stroke:"currentColor",strokeWidth:"4",strokeDasharray:"0 1",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.65,ease:"easeInOut"}}),(0,r.jsx)(h.E.path,{d:"M26 40L36 51L56 29",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeDasharray:"0 1",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:[0,1,1,1,0]},transition:{duration:.35,delay:.5,ease:"easeInOut",opacity:{duration:1.25}}}),(0,r.jsxs)("g",{children:[(0,r.jsx)(h.E.path,{d:"M30.7075 22.75L19.0001 54.2499H25.5625L27.925 47.6349H40.21L42.5987 54.2499H49.1612L37.4275 22.75H30.7075ZM30.0775 41.7812L34.0675 30.7037L38.0837 41.7812H30.0775Z",fill:"currentColor",initial:{opacity:0,x:-6},animate:{opacity:1,x:0},transition:{ease:[.075,.82,.165,1],duration:.5,delay:1.75}}),(0,r.jsx)(h.E.path,{d:"M42.8613 22.75H49.2926L61 54.2499H54.5688L42.8613 22.75Z",fill:"currentColor",initial:{opacity:0,x:6},animate:{opacity:1,x:0},transition:{ease:[.075,.82,.165,1],duration:.5,delay:1.75}})]})]})}),(0,r.jsx)(h.E.h2,{className:"font-styrene-display mt-2 text-4xl font-medium",initial:{opacity:0,x:-24},animate:{opacity:1,x:0},transition:{ease:[.075,.82,.165,1],duration:1,delay:.75},children:s})]})}},83243:function(e,t,n){var i,r;n.d(t,{DF:function(){return s},iw:function(){return a}}),(r=i||(i={})).GoogleTagManager="google_tag_manager",r.GoogleEnhancedConversions="google_enhanced_conversions";let a={analytics:!1,marketing:!1},s={analytics:!0,marketing:!0}},91600:function(e,t,n){n.d(t,{HF:function(){return a},bq:function(){return r}});var i=n(43316);let r=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];try{"function"==typeof window.gtag&&gtag(e,...n)}catch(e){(0,i.Tb)(e)}},a=e=>{r("consent","update",s(e))},s=e=>({ad_personalization:e.marketing?"granted":"denied",ad_user_data:e.marketing?"granted":"denied",ad_storage:e.marketing?"granted":"denied",analytics_storage:e.analytics?"granted":"denied",functionality_storage:"granted",personalization_storage:"granted",security_storage:"granted"})},89937:function(e,t,n){n.d(t,{K:function(){return s}});var i=n(87050),r=n(11492),a=n(21728);let s=()=>{let{segmentKey:e,segmentCdnHost:t,segmentApiHost:n}=(0,r.useConfiguration)(),{value:s}=(0,i.F)("requires_explicit_consent");return a.u.loadIfNecessary({segmentKey:e,segmentCdnHost:t,segmentApiHost:n,requiresExplicitConsent:s})}},21728:function(e,t,n){n.d(t,{u:function(){return p}});var i=n(14983),r=n(70478),a=n(39625),s=n(43316),o=n(27794),l=n.n(o),c=n(83243),u=n(23532);class d{constructor(){this.name="RemoveUserAgent",this.version="1.0.0",this.type="before",this.isLoaded=()=>!0,this.load=()=>Promise.resolve(),this.redactPiiFromContext=e=>{var t;return(null==e?void 0:null===(t=e.event)||void 0===t?void 0:t.context)&&(delete e.event.context.userAgent,delete e.event.context.email,e.event.context.ip="REDACTED"),e},this.track=this.redactPiiFromContext,this.identify=this.redactPiiFromContext,this.page=this.redactPiiFromContext,this.group=this.redactPiiFromContext,this.alias=this.redactPiiFromContext,this.screen=this.redactPiiFromContext}}class h{constructor(){this.consentChangedCallback=l(),this.preferences=h.mapConsentPreferences(c.iw),this.analyticsBrowser=null,this.loadIfNecessary=e=>{let{segmentKey:t,segmentCdnHost:n,segmentApiHost:i,requiresExplicitConsent:r}=e;return this.analyticsBrowser||(this.analyticsBrowser=new a.b,this.loadInitialConsentPreferences(r),this.wrapAnalyticsWithConsent(this.analyticsBrowser).load({writeKey:t,cdnURL:"https://".concat(n),plugins:[new d]},{disableClientPersistence:!0,integrations:{"Segment.io":{apiHost:"".concat(i,"/v1"),protocol:"https"}}}).catch(e=>{(0,s.Tb)(e,{extra:{message:"Failed to load analytics"}})})),this.analyticsBrowser},this.registerOnConsentChanged=e=>{this.consentChangedCallback=e},this.getCategories=()=>this.preferences,this.loadInitialConsentPreferences=e=>{let t;try{t=u.browserCookieStore.get(i.cn.CONSENT_PREFERENCES)}catch(e){(0,s.Tb)(e,{extra:{message:"Failed to get consent preferences cookie"}})}if(t)try{let e=JSON.parse(t);this.preferences=h.mapConsentPreferences(e)}catch(e){console.warn("Malformed consent preferences cookie",t)}else e||(this.preferences=h.mapConsentPreferences(c.DF))},this.updateCategories=e=>{this.preferences=h.mapConsentPreferences(e),this.consentChangedCallback(this.preferences)},this.wrapAnalyticsWithConsent=e=>(0,r.K)({registerOnConsentChanged:this.registerOnConsentChanged,getCategories:this.getCategories})(e)}}h.mapConsentPreferences=e=>({marketing:e.marketing,analytics:e.analytics,necessary:!0});let p=new h}}]);